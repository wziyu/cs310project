Ziyu Wang's contribution to code: Main focus is on PerformQuery and parialy involved in debugging for addDataset.